## Usage

This folder contains some benchmark/experiments for evaluation.

## `bls_pairing`

This file benchmarks two ways to verify BLS signature.
- One is by directly comparing the results of two pairings
- The other is by running Miller's loop on both side and performing only one final exponentiation

You can use feature flag to control which BLS curve the signature runs on
- `sig-12381`: BLS signature runs on BLS12-381
- `sig-12377`: BLS signature runs on BLS12-377

```sh
cargo bench --bench bls_pairing --no-default-features --features sig-12381
cargo bench --bench bls_pairing --no-default-features --features sig-12377
```

## `groth16_single_step_native` and `groth16_single_step_emulation`

These file measures the time to generate public parameters and proofs and verify BLS signatures using Groth16.

As field emulation takes a long time, `groth16_single_step_emulation` is created separately to not use `Criterion` (which requires a sample size of at least 10) for benchmarking. Instead, it uses Rust's built-in `Duration` to measure the wall clock running time. It's recommended to use `groth16_single_step_emulation` when measuring time on emulated field variable.

You can also use feature flags to control which curve is used for BLS signatures and SNARK and whether to use native field or field emulation.
- Note: not all combination of flags are possible. Generally, if the curves support the operation you request (e.g., use native field with sig-12377 and snark-761), you are able to run it.

For example,

```sh
# benchmark using BLS12-381, BLS12-377, and field emulation
cargo bench --bench groth16_single_step_emulation --no-default-features --features "sig-12381 snark-12377 emulated-field"

# benchmark using BLS12-377, BW6-761, and native field
cargo bench --bench groth16_single_step_native --no-default-features --features "sig-12377 snark-761"
```

## `bls_r1cs_constraints`

This file measures the number of constraints generated by each component in an R1CS circuit that verifies a BLS signature.

Similar to the above, you can enter different feature flags to measure the number of constraints generated under different settings.

```sh
cargo bench --bench bls_r1cs_constraints --no-default-features --features "sig-12381 snark-12377 emulated-field"
cargo bench --bench bls_r1cs_constraints --no-default-features --features "sig-12377 snark-761"
```